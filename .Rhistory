geom_bar(position = "fill") +
labs(title = "CHD Proportion by Sex", x = "Sex", y = "Proportion of CHD")
p8<-ggplot(df_chd, aes(x = education, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Education", x = "Education", y = "Proportion of CHD")
p9<-ggplot(df_chd, aes(x = smoker, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Smoker", x = "Smoker", y = "Proportion of CHD")
p10<-ggplot(df_chd, aes(x = stroke, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Stroke", x = "Stroke", y = "Proportion of CHD")
p11<-ggplot(df_chd, aes(x = HTN, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by HTN", x = "HTN", y = "Proportion of CHD")
p12<-ggplot(df_chd, aes(x = diabetes, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Diabetes", x = "Diabetes", y = "Proportion of CHD")
(p7|p8|p9) /
(p10|p11|p12)
table(df_chd$CHD)%>%
kable()
table(df_chd$CHD)
tidy(table(df_chd$CHD))%>%
kable()
table(df_chd$CHD)
table(df_chd$CHD)%>%
kable(col.names = c("No","Yes"))
chd_distrib<-table(df_chd$CHD)
tidy(chd_distrib)%>%
kable()
chd_distrib<-table(df_chd$CHD)
tidy(chd_distrib)%>%
kable(col.names = c("No","Yes"))
table(df_chd$CHD)%>%
kable()
table(df_chd$CHD)
table(df_chd$CHD)%>%
kable(col.names = c("CHD","Freq"))
set.seed(123)
index <- caret::createDataPartition(df_chd$CHD, p = 0.70, list = FALSE)
train_data <- df_chd[index, ]
test_data  <- df_chd[-index, ]
glm_fit <- glm(CHD ~ sex + age + education + smoker
+ cpd + stroke + HTN + diabetes + chol + DBP + BMI +HR,
data = train_data,
family = binomial(link = "logit"))
tidy(glm_fit)%>%
kable()
cm_glm <- confusionMatrix(factor(glm_pred, levels=c("No","Yes")), test_data$CHD)
glm_prob <- predict(glm_fit, newdata = test_data, type = "response")
glm_pred <- ifelse(glm_prob > 0.3, "Yes", "No")
cm_glm <- confusionMatrix(factor(glm_pred, levels=c("No","Yes")), test_data$CHD)
summary_cmglm <- capture.output(cm_glm)
cat(summary_cmglm, sep = "\n")
glm_roc <- roc(response = test_data$CHD,
predictor = glm_prob,
levels = c("No", "Yes"),
direction = "<")
plot(glm_roc, main = "ROC Curve - Logistic Regression (Threshold=0.3)")
plot(glm_roc)
plot(glm_roc)
tidy(auc(glm_roc))%>%
kable(col.names = "Area Under the Curve")
numeric_vars <- c("age","cpd","chol","DBP","BMI","HR")
pre_proc <- preProcess(train_data[, numeric_vars],
method = c("center","scale"))
train_scaled <- train_data
test_scaled  <- test_data
train_scaled[, numeric_vars] <- predict(pre_proc, train_data[, numeric_vars])
test_scaled[, numeric_vars]  <- predict(pre_proc, test_data[, numeric_vars])
ctrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)
tune_grid <- expand.grid(k = seq(1, 100,by=2))
knn_fit <- train(CHD ~ sex + age + education + smoker
+ cpd + stroke + HTN + diabetes + chol + DBP + BMI +HR,
data = train_scaled,
method = "knn",
trControl = ctrl,
tuneGrid = tune_grid)
tidy(knn_fit$bestTune$k)%>%
kable(col.names = "optimal k")
knn_pred <- predict(knn_fit, newdata = test_scaled)
cm_knn <- confusionMatrix(knn_pred, test_scaled$CHD)
summary_cmknn <- capture.output(cm_knn)
cat(summary_cknn, sep = "\n")
summary_cmknn <- capture.output(cm_knn)
cat(summary_cknn, sep = "\n")
summary_cmknn <- capture.output(cm_knn)
cat(summary_cmknn, sep = "\n")
theme_set(theme_minimal())
p1<-ggplot(df_chd, aes(x = CHD, y = age, fill = CHD)) +
geom_boxplot() +
labs(title = "Age Distributions by CHD Status", x = "CHD", y = "Age")
p2<-ggplot(df_chd, aes(x = CHD, y = cpd, fill = CHD)) +
geom_boxplot() +
labs(title = "cpd Distributions by CHD Status", x = "CHD", y = "cpd")
p3<-ggplot(df_chd, aes(x = CHD, y = chol, fill = CHD)) +
geom_boxplot() +
labs(title = "chol Distributions by CHD Status", x = "CHD", y = "chol")
p4<-ggplot(df_chd, aes(x = CHD, y = DBP, fill = CHD)) +
geom_boxplot() +
labs(title = "DBP Distributions by CHD Status", x = "CHD", y = "DBP")
p5<-ggplot(df_chd, aes(x = CHD, y = BMI, fill = CHD)) +
geom_boxplot() +
labs(title = "BMI Distributions by CHD Status", x = "CHD", y = "BMI")
p6<-ggplot(df_chd, aes(x = CHD, y = HR, fill = CHD)) +
geom_boxplot() +
labs(title = "HR Distributions by CHD Status", x = "CHD", y = "HR")
(p1|p2|p3) /
(p4|p5|p6)
theme_set(theme_minimal())
theme_set(theme_minimal())
p1<-ggplot(df_chd, aes(x = CHD, y = age, fill = CHD)) +
geom_boxplot() +
labs(title = "Age Distributions by CHD Status", x = "CHD", y = "Age")
p2<-ggplot(df_chd, aes(x = CHD, y = cpd, fill = CHD)) +
geom_boxplot() +
labs(title = "cpd Distributions by CHD Status", x = "CHD", y = "cpd")
p3<-ggplot(df_chd, aes(x = CHD, y = chol, fill = CHD)) +
geom_boxplot() +
labs(title = "chol Distributions by CHD Status", x = "CHD", y = "chol")
p4<-ggplot(df_chd, aes(x = CHD, y = DBP, fill = CHD)) +
geom_boxplot() +
labs(title = "DBP Distributions by CHD Status", x = "CHD", y = "DBP")
p5<-ggplot(df_chd, aes(x = CHD, y = BMI, fill = CHD)) +
geom_boxplot() +
labs(title = "BMI Distributions by CHD Status", x = "CHD", y = "BMI")
p6<-ggplot(df_chd, aes(x = CHD, y = HR, fill = CHD)) +
geom_boxplot() +
labs(title = "HR Distributions by CHD Status", x = "CHD", y = "HR")
(p1|p2|p3) /
(p4|p5|p6)
p1<-ggplot(df_chd, aes(x = CHD, y = age, fill = CHD)) +
geom_boxplot() +
labs(title = "Age Distributions by CHD Status", x = "CHD", y = "Age")
p2<-ggplot(df_chd, aes(x = CHD, y = cpd, fill = CHD)) +
geom_boxplot() +
labs(title = "cpd Distributions by CHD Status", x = "CHD", y = "cpd")
p3<-ggplot(df_chd, aes(x = CHD, y = chol, fill = CHD)) +
geom_boxplot() +
labs(title = "chol Distributions by CHD Status", x = "CHD", y = "chol")
p4<-ggplot(df_chd, aes(x = CHD, y = DBP, fill = CHD)) +
geom_boxplot() +
labs(title = "DBP Distributions by CHD Status", x = "CHD", y = "DBP")
p5<-ggplot(df_chd, aes(x = CHD, y = BMI, fill = CHD)) +
geom_boxplot() +
labs(title = "BMI Distributions by CHD Status", x = "CHD", y = "BMI")
p6<-ggplot(df_chd, aes(x = CHD, y = HR, fill = CHD)) +
geom_boxplot() +
labs(title = "HR Distributions by CHD Status", x = "CHD", y = "HR")
(p1|p2|p3) /
(p4|p5|p6)
theme_set(theme_minimal())
p1<-ggplot(df_chd, aes(x = CHD, y = age, fill = CHD)) +
geom_boxplot() +
labs(title = "Age Distributions by CHD Status", x = "CHD", y = "Age")
p2<-ggplot(df_chd, aes(x = CHD, y = cpd, fill = CHD)) +
geom_boxplot() +
labs(title = "cpd Distributions by CHD Status", x = "CHD", y = "cpd")
p3<-ggplot(df_chd, aes(x = CHD, y = chol, fill = CHD)) +
geom_boxplot() +
labs(title = "chol Distributions by CHD Status", x = "CHD", y = "chol")
p4<-ggplot(df_chd, aes(x = CHD, y = DBP, fill = CHD)) +
geom_boxplot() +
labs(title = "DBP Distributions by CHD Status", x = "CHD", y = "DBP")
p5<-ggplot(df_chd, aes(x = CHD, y = BMI, fill = CHD)) +
geom_boxplot() +
labs(title = "BMI Distributions by CHD Status", x = "CHD", y = "BMI")
p6<-ggplot(df_chd, aes(x = CHD, y = HR, fill = CHD)) +
geom_boxplot() +
labs(title = "HR Distributions by CHD Status", x = "CHD", y = "HR")
(p1|p2|p3) /
(p4|p5|p6)
knitr::opts_chunk$set(warning=FALSE,
message=FALSE,
tidy.opts=list(width.cutoff = 80),
tidy = TRUE)
library(tidyverse)
library(dplyr)
library(ggplot2)
library(caret)
library(pROC)
library(kableExtra)
library(tidymodels)
df_chd<- read.csv("chd.csv")
df_chd$sex<- factor(df_chd$sex)
df_chd$education<- factor(df_chd$education)
df_chd$smoker<- factor(df_chd$smoker)
df_chd$stroke<- factor(df_chd$stroke)
df_chd$HTN<- factor(df_chd$HTN)
df_chd$diabetes<- factor(df_chd$diabetes)
df_chd$CHD<- factor(df_chd$CHD)
summary_text <- capture.output(summary(df_chd))
cat(summary_text, sep = "\n")
df_chd <- df_chd %>%
mutate(
across(
.cols = c(chol, DBP, BMI, HR),
.fns = ~ ifelse(is.na(.), median(., na.rm = TRUE), .)
)
)
df_chd$cpd[is.na(df_chd$cpd)] <- median(df_chd$cpd, na.rm = TRUE)
mode_edu <- names(sort(table(df_chd$education), decreasing = TRUE))[1]
df_chd$education[is.na(df_chd$education)] <- mode_edu
theme_set(theme_minimal())
p1<-ggplot(df_chd, aes(x = CHD, y = age, fill = CHD)) +
geom_boxplot() +
labs(title = "Age Distributions by CHD Status", x = "CHD", y = "Age")
p2<-ggplot(df_chd, aes(x = CHD, y = cpd, fill = CHD)) +
geom_boxplot() +
labs(title = "cpd Distributions by CHD Status", x = "CHD", y = "cpd")
p3<-ggplot(df_chd, aes(x = CHD, y = chol, fill = CHD)) +
geom_boxplot() +
labs(title = "chol Distributions by CHD Status", x = "CHD", y = "chol")
p4<-ggplot(df_chd, aes(x = CHD, y = DBP, fill = CHD)) +
geom_boxplot() +
labs(title = "DBP Distributions by CHD Status", x = "CHD", y = "DBP")
p5<-ggplot(df_chd, aes(x = CHD, y = BMI, fill = CHD)) +
geom_boxplot() +
labs(title = "BMI Distributions by CHD Status", x = "CHD", y = "BMI")
p6<-ggplot(df_chd, aes(x = CHD, y = HR, fill = CHD)) +
geom_boxplot() +
labs(title = "HR Distributions by CHD Status", x = "CHD", y = "HR")
(p1|p2|p3) /
(p4|p5|p6)
p7<-ggplot(df_chd, aes(x = sex, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Sex", x = "Sex", y = "Proportion of CHD")
p8<-ggplot(df_chd, aes(x = education, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Education", x = "Education", y = "Proportion of CHD")
p9<-ggplot(df_chd, aes(x = smoker, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Smoker", x = "Smoker", y = "Proportion of CHD")
p10<-ggplot(df_chd, aes(x = stroke, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Stroke", x = "Stroke", y = "Proportion of CHD")
p11<-ggplot(df_chd, aes(x = HTN, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by HTN", x = "HTN", y = "Proportion of CHD")
p12<-ggplot(df_chd, aes(x = diabetes, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Diabetes", x = "Diabetes", y = "Proportion of CHD")
(p7|p8|p9) /
(p10|p11|p12)
table(df_chd$CHD)%>%
kable(col.names = c("CHD","Freq"))
set.seed(123)
index <- caret::createDataPartition(df_chd$CHD, p = 0.70, list = FALSE)
train_data <- df_chd[index, ]
test_data  <- df_chd[-index, ]
glm_fit <- glm(CHD ~ sex + age + education + smoker
+ cpd + stroke + HTN + diabetes
+ chol + DBP + BMI +HR,
data = train_data,
family = binomial(link = "logit"))
tidy(glm_fit)%>%
kable()
glm_prob <- predict(glm_fit, newdata = test_data, type = "response")
glm_pred <- ifelse(glm_prob > 0.3, "Yes", "No")
cm_glm <- confusionMatrix(factor(glm_pred, levels=c("No","Yes")),
test_data$CHD)
summary_cmglm <- capture.output(cm_glm)
cat(summary_cmglm, sep = "\n")
glm_roc <- roc(response = test_data$CHD,
predictor = glm_prob,
levels = c("No", "Yes"),
direction = "<")
plot(glm_roc)
tidy(auc(glm_roc))%>%
kable(col.names = "Area Under the Curve")
numeric_vars <- c("age","cpd","chol","DBP","BMI","HR")
pre_proc <- preProcess(train_data[, numeric_vars],
method = c("center","scale"))
train_scaled <- train_data
test_scaled  <- test_data
train_scaled[, numeric_vars] <- predict(pre_proc,
train_data[, numeric_vars])
test_scaled[, numeric_vars]  <- predict(pre_proc,
test_data[, numeric_vars])
ctrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)
tune_grid <- expand.grid(k = seq(1, 100,by=2))
knn_fit <- train(CHD ~ sex + age + education + smoker
+ cpd + stroke + HTN + diabetes
+ chol + DBP + BMI +HR,
data = train_scaled,
method = "knn",
trControl = ctrl,
tuneGrid = tune_grid)
tidy(knn_fit$bestTune$k)%>%
kable(col.names = "optimal k")
knn_pred <- predict(knn_fit, newdata = test_scaled)
cm_knn <- confusionMatrix(knn_pred, test_scaled$CHD)
summary_cmknn <- capture.output(cm_knn)
cat(summary_cmknn, sep = "\n")
theme_set(theme_minimal())
p1<-ggplot(df_chd, aes(x = CHD, y = age, fill = CHD)) +
geom_boxplot() +
labs(title = "Age Distributions by CHD Status", x = "CHD", y = "Age")
p2<-ggplot(df_chd, aes(x = CHD, y = cpd, fill = CHD)) +
geom_boxplot() +
labs(title = "cpd Distributions by CHD Status", x = "CHD", y = "cpd")
p3<-ggplot(df_chd, aes(x = CHD, y = chol, fill = CHD)) +
geom_boxplot() +
labs(title = "chol Distributions by CHD Status", x = "CHD", y = "chol")
p4<-ggplot(df_chd, aes(x = CHD, y = DBP, fill = CHD)) +
geom_boxplot() +
labs(title = "DBP Distributions by CHD Status", x = "CHD", y = "DBP")
p5<-ggplot(df_chd, aes(x = CHD, y = BMI, fill = CHD)) +
geom_boxplot() +
labs(title = "BMI Distributions by CHD Status", x = "CHD", y = "BMI")
p6<-ggplot(df_chd, aes(x = CHD, y = HR, fill = CHD)) +
geom_boxplot() +
labs(title = "HR Distributions by CHD Status", x = "CHD", y = "HR")
(p1|p2|p3) /
(p4|p5|p6)
theme_set(theme_minimal())
p1<-ggplot(df_chd, aes(x = CHD, y = age, fill = CHD)) +
geom_boxplot() +
labs(title = "Age Distributions by CHD Status", x = "CHD", y = "Age")
p2<-ggplot(df_chd, aes(x = CHD, y = cpd, fill = CHD)) +
geom_boxplot() +
labs(title = "cpd Distributions by CHD Status", x = "CHD", y = "cpd")
p3<-ggplot(df_chd, aes(x = CHD, y = chol, fill = CHD)) +
geom_boxplot() +
labs(title = "chol Distributions by CHD Status", x = "CHD", y = "chol")
p4<-ggplot(df_chd, aes(x = CHD, y = DBP, fill = CHD)) +
geom_boxplot() +
labs(title = "DBP Distributions by CHD Status", x = "CHD", y = "DBP")
p5<-ggplot(df_chd, aes(x = CHD, y = BMI, fill = CHD)) +
geom_boxplot() +
labs(title = "BMI Distributions by CHD Status", x = "CHD", y = "BMI")
p6<-ggplot(df_chd, aes(x = CHD, y = HR, fill = CHD)) +
geom_boxplot() +
labs(title = "HR Distributions by CHD Status", x = "CHD", y = "HR")
(p1|p2|p3)/
(p4|p5|p6)
library(tidyverse)
library(patchwork)
library(dplyr)
library(ggplot2)
library(caret)
library(pROC)
library(kableExtra)
library(tidymodels)
knitr::opts_chunk$set(warning=FALSE,
message=FALSE,
tidy.opts=list(width.cutoff = 50),
tidy = TRUE)
library(tidyverse)
library(patchwork)
library(dplyr)
library(ggplot2)
library(caret)
library(pROC)
library(kableExtra)
library(knitr)
library(tidymodels)
df_chd<- read.csv("chd.csv")
setwd("C:/Users/bonom/OneDrive/Desktop/homework_Bonomo")
knitr::opts_chunk$set(warning=FALSE,
message=FALSE,
tidy.opts=list(width.cutoff = 50),
tidy = TRUE)
library(tidyverse)
library(patchwork)
library(dplyr)
library(ggplot2)
library(caret)
library(pROC)
library(kableExtra)
library(knitr)
library(tidymodels)
df_chd<- read.csv("chd.csv")
knitr::opts_chunk$set(warning=FALSE,
message=FALSE,
tidy.opts=list(width.cutoff = 50),
tidy = TRUE)
library(tidyverse)
library(patchwork)
library(dplyr)
library(ggplot2)
library(caret)
library(pROC)
library(kableExtra)
library(knitr)
library(tidymodels)
df_chd<- read.csv("chd.csv")
df_chd$sex<- factor(df_chd$sex)
df_chd$education<- factor(df_chd$education)
df_chd$smoker<- factor(df_chd$smoker)
df_chd$stroke<- factor(df_chd$stroke)
df_chd$HTN<- factor(df_chd$HTN)
df_chd$diabetes<- factor(df_chd$diabetes)
df_chd$CHD<- factor(df_chd$CHD)
sapply(df_chd, function(x) sum(is.na(x)))
df_chd <- df_chd %>%
mutate(
across(
.cols = c(chol, DBP, BMI, HR),
.fns = ~ ifelse(is.na(.), median(., na.rm = TRUE), .)
)
)
df_chd$cpd[is.na(df_chd$cpd)] <- median(df_chd$cpd, na.rm = TRUE)
mode_edu <- names(sort(table(df_chd$education), decreasing = TRUE))[1]
df_chd$education[is.na(df_chd$education)] <- mode_edu
theme_set(theme_minimal())
p1<-ggplot(df_chd, aes(x = CHD, y = age, fill = CHD)) +
geom_boxplot() +
labs(title = "Age Distributions by CHD Status", x = "CHD", y = "Age")
p2<-ggplot(df_chd, aes(x = CHD, y = cpd, fill = CHD)) +
geom_boxplot() +
labs(title = "cpd Distributions by CHD Status", x = "CHD", y = "cpd")
p3<-ggplot(df_chd, aes(x = CHD, y = chol, fill = CHD)) +
geom_boxplot() +
labs(title = "chol Distributions by CHD Status", x = "CHD", y = "chol")
p4<-ggplot(df_chd, aes(x = CHD, y = DBP, fill = CHD)) +
geom_boxplot() +
labs(title = "DBP Distributions by CHD Status", x = "CHD", y = "DBP")
p5<-ggplot(df_chd, aes(x = CHD, y = BMI, fill = CHD)) +
geom_boxplot() +
labs(title = "BMI Distributions by CHD Status", x = "CHD", y = "BMI")
p6<-ggplot(df_chd, aes(x = CHD, y = HR, fill = CHD)) +
geom_boxplot() +
labs(title = "HR Distributions by CHD Status", x = "CHD", y = "HR")
(p1|p2|p3)/
(p4|p5|p6)
p7<-ggplot(df_chd, aes(x = sex, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Sex", x = "Sex", y = "Proportion of CHD")
p8<-ggplot(df_chd, aes(x = education, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Education", x = "Education", y = "Proportion of CHD")
p9<-ggplot(df_chd, aes(x = smoker, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Smoker", x = "Smoker", y = "Proportion of CHD")
p10<-ggplot(df_chd, aes(x = stroke, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Stroke", x = "Stroke", y = "Proportion of CHD")
p11<-ggplot(df_chd, aes(x = HTN, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by HTN", x = "HTN", y = "Proportion of CHD")
p12<-ggplot(df_chd, aes(x = diabetes, fill = CHD)) +
geom_bar(position = "fill") +
labs(title = "CHD Proportion by Diabetes", x = "Diabetes", y = "Proportion of CHD")
(p7|p8|p9) /
(p10|p11|p12)
table(df_chd$CHD)%>%
kable(col.names = c("CHD","Freq"))
set.seed(123)
index <- caret::createDataPartition(df_chd$CHD, p = 0.70, list = FALSE)
train_data <- df_chd[index, ]
test_data  <- df_chd[-index, ]
glm_fit <- glm(
CHD ~ .,
data = train_data,
family = binomial(link = "logit")
)
tidy(glm_fit)%>%
kable(format = "latex")%>%
kable_styling(font_size=8)
glm_prob <- predict(glm_fit, newdata = test_data, type = "response")
glm_pred <- ifelse(glm_prob > 0.3, "Yes", "No")
cm_glm <- confusionMatrix(factor(glm_pred, levels=c("No","Yes")),
test_data$CHD)
cm_glm$table
accuarcy_glm<- cm_glm$overall["Accuracy"]
sensitivy_glm<- cm_glm$byClass["Sensitivity"]
specificity_glm<- cm_glm$byClass["Specificity"]
metrics_df <- data.frame(
Accuracy    = cm_glm$overall["Accuracy"],
Sensitivity = cm_glm$byClass["Sensitivity"],
Specificity = cm_glm$byClass["Specificity"]
)
kable(metrics_df, digits = 3, row.names = FALSE)
glm_roc <- roc(response = test_data$CHD,
predictor = glm_prob,
levels = c("No", "Yes"),
direction = "<")
plot(glm_roc)
tidy(auc(glm_roc))%>%
kable(col.names = "Area Under the Curve")
numeric_vars <- c("age","cpd","chol","DBP","BMI","HR")
pre_proc <- preProcess(
train_data[, numeric_vars],
method = c("center","scale")
)
train_scaled <- train_data
test_scaled  <- test_data
train_scaled[, numeric_vars] <- predict(pre_proc,
train_data[, numeric_vars])
test_scaled[, numeric_vars]  <- predict(pre_proc,
test_data[, numeric_vars])
ctrl <- trainControl(method = "repeatedcv", number = 10, repeats = 3)
tune_grid <- expand.grid(k = seq(1, 100,by=2))
knn_fit <- train(
CHD ~ .,
data = train_scaled,
method = "knn",
trControl = ctrl,
tuneGrid = tune_grid
)
tidy(knn_fit$bestTune$k)%>%
kable(col.names = "optimal k")
knn_pred <- predict(knn_fit, newdata = test_scaled)
cm_knn <- confusionMatrix(knn_pred, test_scaled$CHD)
cm_knn$table
metrics_df <- data.frame(
Accuracy    = cm_knn$overall["Accuracy"],
Sensitivity = cm_knn$byClass["Sensitivity"],
Specificity = cm_knn$byClass["Specificity"]
)
kable(metrics_df, digits = 3, row.names = FALSE)
